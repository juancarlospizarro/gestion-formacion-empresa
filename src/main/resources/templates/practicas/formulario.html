<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formación en Empresa - Añadir/Editar práctica</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body class="bg-light">
	
	<div th:replace="~{fragmentos/header :: header}"></div>
	
	<div class="container my-5">
	        <div class="row justify-content-center">
	            <div class="col-md-8">
	                <div class="card shadow-sm border-0">
	                    <div class="card-header bg-primary text-white py-3">
	                        <h4 class="mb-0">
	                            <i class="bi bi-briefcase me-2"></i>
	                            <span>Asignar Práctica</span>
	                        </h4>
	                    </div>
	                    <div class="card-body p-4">
	                        <form th:action="@{/practicas/guardar}" th:object="${practica}" method="post" class="row g-3">
	                            <input type="hidden" th:field="*{id}">
								<div th:if="${#fields.hasAnyErrors()}" class="alert alert-danger col-12 py-2">
								    <ul class="mb-0">
								        <li th:each="err : ${#fields.allErrors()}" 
								            th:if="${err.contains('fecha') or err.contains('posterior')}" 
								            th:text="${err}"></li>
								    </ul>
								</div>

								<div class="col-md-6">
								    <label class="form-label fw-bold">Alumno</label>
								    
								    <input type="hidden" th:if="${practica.id != null}" th:field="*{alumno}">

								    <select th:field="*{alumno}" class="form-select" 
								            th:disabled="${practica.id != null}" required>
								        <option value="">-- Seleccionar Alumno --</option>
								        <option th:each="a : ${listaAlumnos}" 
								                th:value="${a.id}" 
								                th:text="${a.nombre + ' ' + a.apellidos}">
								        </option>
								    </select>
								    
								    <div th:if="${practica.id != null}" class="form-text text-muted">
								        El alumno no se puede modificar. Si es un error, elimine la práctica.
								    </div>
								</div>

	                            <div class="col-md-6">
	                                <label for="empresa" class="form-label fw-bold">Empresa</label>
	                                <select th:field="*{empresa}" class="form-select" id="empresa" required>
	                                    <option value="">-- Seleccionar Empresa --</option>
	                                    <option th:each="e : ${listaEmpresas}" 
	                                            th:value="${e.id}" 
	                                            th:text="${e.nombre}">
	                                    </option>
	                                </select>
	                            </div>

	                            <div class="col-md-6">
	                                <label for="fechaInicio" class="form-label fw-bold">Fecha de Inicio</label>
	                                <input type="date" th:field="*{fechaInicio}" class="form-control" id="fechaInicio" required>
	                            </div>

	                            <div class="col-md-6">
	                                <label for="fechaFin" class="form-label fw-bold">Fecha de Finalización</label>
	                                <input type="date" th:field="*{fechaFin}" class="form-control" id="fechaFin" required>
	                            </div>

	                            <div class="col-12">
	                                <label for="comentarios" class="form-label fw-bold">Comentarios</label>
	                                <textarea th:field="*{comentarios}" class="form-control" id="comentarios" rows="4" 
	                                          placeholder="Describe brevemente las tareas del alumno en la empresa..." required></textarea>
	                            </div>

	                            <div class="col-12 mt-5 d-flex justify-content-between">
	                                <a th:href="@{/practicas}" class="btn btn-outline-secondary">
	                                    <i class="bi bi-arrow-left"></i> Volver al Listado
	                                </a>
	                                <button type="submit" class="btn btn-primary px-5">
	                                    <i class="bi bi-check-circle"></i> Confirmar Asignación
	                                </button>
	                            </div>
	                        </form>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	
		<div th:replace="~{fragmentos/footer :: footer}"></div>
	
</body>
</html>